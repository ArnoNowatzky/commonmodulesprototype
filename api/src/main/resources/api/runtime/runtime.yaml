openapi: "3.0.0"
info:
  version: 1.0.0
  title: "runtime api"
  description: "API which is provided by the module runtime itself"
servers:
  - url: http://localhost:8001
security:
  - BasicAuth

paths:
  /module/setup:
    post:
      tags:
        - module
      operationId: "installModules"
      description: "sets the modules up due to the description"
      requestBody:
        required: true
        description: modules descriptor
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SetupModulesParamDTO"

      responses:
        '200':
          description: Ok
  /module/start:
    post:
      tags:
        - module
      operationId: "startModules"
      description: "starts the modules up due to the description"
      requestBody:
        required: true
        description: modules descriptor
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SetupModulesParamDTO"

      responses:
        '200':
          description: Ok

  /module/stop:
    post:
      tags:
        - module
      operationId: "stopModules"
      description: "stops the modules up due to the description"
      requestBody:
        required: true
        description: modules descriptor
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SetupModulesParamDTO"


      responses:
        '200':
          description: Ok
  /module/status:
    post:
      tags:
        - module
      operationId: "statusModules"
      description: "gets the status of the modules up due to the description"
      requestBody:
        required: true
        description: modules descriptor
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SetupModulesParamDTO"

      responses:
        '200':
          description: status of modules
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/StatusModulesReturnDTO"


components:
  securitySchemes:
    BasicAuth:
      type: http
      scheme: basic

  schemas:
    SetupModulesParamDTO:
      type: "object"
      properties:
        path:
          type: "string"
        descriptor: 
          type: "string"
        affectedModules:
          type: array
          items:
            type: string
    StatusModulesReturnDTO:
      type: "object"
      properties:
        modules:
          type: array
          items:
            $ref: "#/components/schemas/StatusModuleReturnDTO"
    StatusModuleReturnDTO:
      type: "object"
      properties:
        id:
          type: "string"
        running:
          type: "boolean"
        instanceId:
          type: "string"
